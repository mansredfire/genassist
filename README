# ğŸ¤– BugPredict AI - Enhanced Vulnerability Prediction System

> AI-powered vulnerability prediction and attack chain detection for bug bounty hunters and security researchers

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

---

## ğŸ¯ What is BugPredict AI?

BugPredict AI is a production-ready machine learning system that predicts vulnerabilities, detects attack chains, and generates actionable test strategies for security researchers and bug bounty hunters.

### âœ¨ Key Features

- **40+ Vulnerability Types**: Comprehensive coverage including modern API, GraphQL, cloud, and authentication vulnerabilities
- **25+ Attack Chains**: Automated detection of multi-step exploitation paths
- **Ensemble ML Models**: Random Forest, XGBoost, LightGBM, CatBoost, Gradient Boosting
- **Multi-Source Data Collection**: HackerOne, Bugcrowd, NVD/CVE integration
- **100+ Features**: Advanced feature engineering from vulnerability reports
- **Technology-Aware**: Smart predictions based on your tech stack
- **Test Strategy Generation**: Actionable testing recommendations with tools and endpoints
- **Production Ready**: Complete CLI tools, API, and Jupyter notebooks

---

## ğŸ“Š Supported Vulnerability Types

### Access Control (4 types)
- IDOR
- Broken Access Control
- Broken Authorization
- Privilege Escalation

### Authentication (5 types)
- Authentication Bypass
- Broken Authentication
- Session Fixation
- JWT Vulnerabilities
- Account Takeover

### Injection (6 types)
- SQL Injection
- NoSQL Injection
- Command Injection
- XSS (all variants)
- XXE
- GraphQL Injection

### API Security (5 types)
- API Abuse
- Excessive Data Exposure
- Rate Limiting Issues
- GraphQL Introspection
- GraphQL Batching Abuse

### SSRF & Cloud (3 types)
- SSRF
- Cloud Misconfiguration
- S3 Bucket Exposure

### Business Logic (3 types)
- Business Logic Flaws
- Race Conditions
- Webhook Abuse

### Configuration (3 types)
- CORS Misconfiguration
- Exposed Admin Interface
- Weak Cryptography

### And 11 more types...

---

## ğŸš€ Quick Start

### Prerequisites

- Python 3.10 or higher
- 8GB RAM minimum (16GB recommended)
- 10GB free disk space

### Installation

**Using Bash (Linux/Mac):**
```bash
# Clone the repository
git clone https://github.com/yourusername/bugpredict-ai.git
cd bugpredict-ai

# Create virtual environment
python3 -m venv venv
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Verify installation
python -c "import src; print('âœ“ Installation successful!')"
```

**Using PowerShell (Windows):**
```powershell
# Clone the repository
git clone https://github.com/yourusername/bugpredict-ai.git
cd bugpredict-ai

# Create virtual environment
python -m venv venv
.\venv\Scripts\Activate.ps1

# Install dependencies
pip install -r requirements.txt

# Verify installation
python -c "import src; print('âœ“ Installation successful!')"
```

---

## ğŸ“š Usage Examples

### 1. Analyze a Single Target

**Bash:**
```bash
python scripts/analyze_target.py \
  --domain example.com \
  --company "Example Corp" \
  --tech React Node.js PostgreSQL \
  --auth \
  --api \
  --output results.json
```

**PowerShell:**
```powershell
python scripts/analyze_target.py `
  --domain example.com `
  --company "Example Corp" `
  --tech React Node.js PostgreSQL `
  --auth `
  --api `
  --output results.json
```

**Output:**
```
================================================================================================
ANALYZING TARGET: example.com
================================================================================================

Loading models...
  âœ“ Loaded FeatureEngineer
  âœ“ Loaded VulnerabilityPredictor
  âœ“ Loaded SeverityPredictor
  âœ“ Loaded ChainDetector

Extracting features...
Generated 156 features

Predicting vulnerabilities...
Predicting severities...
Detecting vulnerability chains...

âœ“ Analysis complete!
Risk Score: 7.2/10 (HIGH)
Top Vulnerabilities: 8
Chains Detected: 3

[Full detailed report displayed]
```

### 2. Batch Analysis from File

**Create targets file (targets.csv):**
```csv
domain,company,tech_stack,auth_required,has_api
example.com,Example Corp,"React,Node.js,MongoDB",true,true
test.io,Test Inc,"Angular,Java,MySQL",true,true
demo.app,Demo LLC,"Vue.js,Python,PostgreSQL",false,true
```

**Bash:**
```bash
python scripts/batch_analyze.py \
  --input targets.csv \
  --output batch_results.json
```

**PowerShell:**
```powershell
python scripts/batch_analyze.py `
  --input targets.csv `
  --output batch_results.json
```

### 3. Collect Vulnerability Data

**Bash:**
```bash
# Collect from all sources
python scripts/collect_data.py \
  --source all \
  --limit 5000 \
  --output data/raw

# Collect from specific source
python scripts/collect_data.py \
  --source hackerone \
  --hackerone-token YOUR_TOKEN \
  --limit 2000

# Collect CVEs from last 180 days
python scripts/collect_data.py \
  --source cve \
  --days-back 180 \
  --nvd-api-key YOUR_KEY
```

**PowerShell:**
```powershell
# Collect from all sources
python scripts/collect_data.py `
  --source all `
  --limit 5000 `
  --output data/raw

# Collect from specific source
python scripts/collect_data.py `
  --source hackerone `
  --hackerone-token YOUR_TOKEN `
  --limit 2000

# Collect CVEs from last 180 days
python scripts/collect_data.py `
  --source cve `
  --days-back 180 `
  --nvd-api-key YOUR_KEY
```

### 4. Train Models

**Bash:**
```bash
# Quick training (for testing)
python scripts/train_model.py --quick

# Full training with custom config
python scripts/train_model.py \
  --config config/training_config.yaml

# Train specific models only
python scripts/train_model.py \
  --models vulnerability severity
```

**PowerShell:**
```powershell
# Quick training (for testing)
python scripts/train_model.py --quick

# Full training with custom config
python scripts/train_model.py `
  --config config/training_config.yaml

# Train specific models only
python scripts/train_model.py `
  --models vulnerability severity
```

### 5. Evaluate Models

**Bash:**
```bash
python scripts/evaluate_models.py \
  --models-dir data/models \
  --test-data data/test/reports.pkl
```

**PowerShell:**
```powershell
python scripts/evaluate_models.py `
  --models-dir data/models `
  --test-data data/test/reports.pkl
```

---

## ğŸ”„ Migration to Enhanced System

If you have an existing BugPredict AI installation, use the migration script to upgrade to the enhanced version with 40+ vulnerability types.

### Migration Steps

**Bash:**
```bash
# Preview migration (dry run)
python scripts/migrate_to_enhanced.py --dry-run

# Execute migration
python scripts/migrate_to_enhanced.py

# Force migration (skip confirmation)
python scripts/migrate_to_enhanced.py --force
```

**PowerShell:**
```powershell
# Preview migration (dry run)
python scripts/migrate_to_enhanced.py --dry-run

# Execute migration
python scripts/migrate_to_enhanced.py

# Force migration (skip confirmation)
python scripts/migrate_to_enhanced.py --force
```

### What the Migration Does

1. âœ… **Backs up** existing models and data
2. âœ… **Reprocesses** reports with enhanced vulnerability detection
3. âœ… **Updates** vulnerability type mappings
4. âœ… **Retrains** models with new types
5. âœ… **Generates** migration report with statistics
6. âœ… **Validates** enhanced detection

**Migration Report Example:**
```
================================================================================================
MIGRATION SUMMARY
================================================================================================
Reports processed: 8,547
Types updated: 1,234
New types: 24
Models retrained: 3

New Vulnerability Type Mappings:
  NoSQL Injection: 156 reports (from: SQL Injection, Other)
  GraphQL Introspection: 89 reports (from: Information Disclosure, API Abuse)
  JWT Vulnerabilities: 234 reports (from: Authentication Bypass, Broken Authentication)
  Cloud Misconfiguration: 67 reports (from: SSRF, Information Disclosure)
  ...
```

---

## ğŸ§ª Running Tests

### Complete Test Suite

**Bash:**
```bash
# Run all tests
pytest tests/ -v

# Run specific test file
pytest tests/test_enhanced_vulnerabilities.py -v

# Run with coverage
pytest tests/ --cov=src --cov-report=html

# Run specific test class
pytest tests/test_enhanced_vulnerabilities.py::TestEnhancedVulnerabilityExtractor -v

# Run performance tests only
pytest tests/test_enhanced_vulnerabilities.py::TestPerformance -v
```

**PowerShell:**
```powershell
# Run all tests
pytest tests/ -v

# Run specific test file
pytest tests/test_enhanced_vulnerabilities.py -v

# Run with coverage
pytest tests/ --cov=src --cov-report=html

# Run specific test class
pytest tests/test_enhanced_vulnerabilities.py::TestEnhancedVulnerabilityExtractor -v

# Run performance tests only
pytest tests/test_enhanced_vulnerabilities.py::TestPerformance -v
```

### Test Categories

- **Unit Tests**: Test individual components (extractors, models, chains)
- **Integration Tests**: Test end-to-end workflows
- **Performance Tests**: Benchmark detection speed
- **Coverage Tests**: Ensure all 40+ vulnerability types are detected

**Expected Output:**
```
tests/test_enhanced_vulnerabilities.py::TestEnhancedVulnerabilityExtractor::test_idor_detection PASSED
tests/test_enhanced_vulnerabilities.py::TestEnhancedVulnerabilityExtractor::test_nosql_injection_detection PASSED
tests/test_enhanced_vulnerabilities.py::TestEnhancedVulnerabilityExtractor::test_jwt_vulnerabilities_detection PASSED
...
tests/test_enhanced_vulnerabilities.py::TestPerformance::test_extraction_performance PASSED

Performance: 1,250 extractions/second
Chain detection: 156 detections/second

============================================ 127 passed in 12.34s ============================================
```

---

## ğŸ“– Complete Workflow Example

Here's a complete workflow from data collection to vulnerability prediction:

### Step 1: Collect Data

**Bash:**
```bash
# Collect vulnerability data
python scripts/collect_data.py \
  --source all \
  --limit 10000 \
  --hackerone-token $H1_TOKEN \
  --nvd-api-key $NVD_KEY
```

**PowerShell:**
```powershell
# Collect vulnerability data
python scripts/collect_data.py `
  --source all `
  --limit 10000 `
  --hackerone-token $env:H1_TOKEN `
  --nvd-api-key $env:NVD_KEY
```

### Step 2: Train Models

**Bash:**
```bash
# Train ML models
python scripts/train_model.py \
  --config config/training_config.yaml
```

**PowerShell:**
```powershell
# Train ML models
python scripts/train_model.py `
  --config config/training_config.yaml
```

### Step 3: Analyze Target

**Bash:**
```bash
# Analyze your target
python scripts/analyze_target.py \
  --domain bugcrowd.com \
  --company Bugcrowd \
  --tech React Node.js PostgreSQL Redis AWS \
  --auth \
  --api \
  --output analysis_bugcrowd.json
```

**PowerShell:**
```powershell
# Analyze your target
python scripts/analyze_target.py `
  --domain bugcrowd.com `
  --company Bugcrowd `
  --tech React Node.js PostgreSQL Redis AWS `
  --auth `
  --api `
  --output analysis_bugcrowd.json
```

### Step 4: Review Results
```bash
# View results
cat analysis_bugcrowd.json | jq '.vulnerability_predictions[:5]'
```

**Output:**
```json
[
  {
    "vulnerability_type": "GraphQL Introspection",
    "probability": 0.82,
    "confidence": "high",
    "priority": 5,
    "technology_relevance": "critical"
  },
  {
    "vulnerability_type": "IDOR",
    "probability": 0.76,
    "confidence": "high",
    "priority": 4,
    "technology_relevance": "high"
  },
  {
    "vulnerability_type": "Rate Limiting Issues",
    "probability": 0.71,
    "confidence": "medium",
    "priority": 4,
    "technology_relevance": "high"
  }
]
```

---

## ğŸ› ï¸ All Available Scripts

### Data Collection Scripts

| Script | Purpose | Bash Example | PowerShell Example |
|--------|---------|--------------|-------------------|
| `collect_data.py` | Collect vulnerability data | `python scripts/collect_data.py --source all --limit 5000` | `python scripts/collect_data.py --source all --limit 5000` |

**Options:**
- `--source`: Data source (`hackerone`, `bugcrowd`, `cve`, `all`)
- `--limit`: Maximum reports to collect
- `--output`: Output directory
- `--hackerone-token`: HackerOne API token
- `--bugcrowd-token`: Bugcrowd API token
- `--nvd-api-key`: NVD API key
- `--days-back`: For CVE collection, days to look back
- `--no-cache`: Disable caching

### Model Training Scripts

| Script | Purpose | Bash Example | PowerShell Example |
|--------|---------|--------------|-------------------|
| `train_model.py` | Train ML models | `python scripts/train_model.py --quick` | `python scripts/train_model.py --quick` |

**Options:**
- `--config`: Training configuration file
- `--quick`: Quick training mode (reduced data)
- `--skip-collection`: Use cached data
- `--models`: Specific models to train

### Analysis Scripts

| Script | Purpose | Bash Example | PowerShell Example |
|--------|---------|--------------|-------------------|
| `analyze_target.py` | Analyze single target | `python scripts/analyze_target.py -d example.com --tech React Node.js` | `python scripts/analyze_target.py -d example.com --tech React Node.js` |
| `batch_analyze.py` | Analyze multiple targets | `python scripts/batch_analyze.py -i targets.csv -o results.json` | `python scripts/batch_analyze.py -i targets.csv -o results.json` |

**analyze_target.py Options:**
- `--domain, -d`: Target domain (required)
- `--company, -c`: Company name
- `--tech, -t`: Technology stack (space-separated)
- `--endpoints, -e`: API endpoints (space-separated)
- `--auth`: Target requires authentication
- `--api`: Target has API endpoints
- `--output, -o`: Output file (JSON)
- `--models-dir`: Models directory

**batch_analyze.py Options:**
- `--input, -i`: Input file (CSV, JSON, or TXT)
- `--output, -o`: Output file (JSON)
- `--models-dir`: Models directory
- `--threads`: Parallel threads (not implemented yet)

### Testing Scripts

| Script | Purpose | Bash Example | PowerShell Example |
|--------|---------|--------------|-------------------|
| `evaluate_models.py` | Evaluate model performance | `python scripts/evaluate_models.py --test-data data/test.pkl` | `python scripts/evaluate_models.py --test-data data/test.pkl` |
| `pytest` | Run test suite | `pytest tests/ -v --cov=src` | `pytest tests/ -v --cov=src` |

**evaluate_models.py Options:**
- `--models-dir`: Models directory
- `--test-data`: Test data file (pickle)

### Migration Scripts

| Script | Purpose | Bash Example | PowerShell Example |
|--------|---------|--------------|-------------------|
| `migrate_to_enhanced.py` | Migrate to enhanced system | `python scripts/migrate_to_enhanced.py --dry-run` | `python scripts/migrate_to_enhanced.py --dry-run` |

**Options:**
- `--dry-run`: Preview changes without applying
- `--force`: Skip confirmation
- `--skip-backup`: Skip backup (not recommended)

### Utility Scripts

| Script | Purpose | Bash Example | PowerShell Example |
|--------|---------|--------------|-------------------|
| `generate_nuclei_templates.py` | Generate Nuclei templates | `python scripts/generate_nuclei_templates.py -t example.com` | `python scripts/generate_nuclei_templates.py -t example.com` |

**Options:**
- `--target, -t`: Target domain
- `--output-dir, -o`: Output directory for templates
- `--min-probability`: Minimum probability threshold
- `--models-dir`: Models directory

---

## ğŸ”§ Configuration

### Training Configuration (`config/training_config.yaml`)
```yaml
data_collection:
  collect_hackerone: true
  hackerone_limit: 5000
  collect_bugcrowd: true
  bugcrowd_limit: 2000
  collect_cve: true
  cve_start_date: '2020-01-01'
  cve_limit: 3000

preprocessing:
  remove_duplicates: true
  normalize_text: true
  min_report_quality: 0.5

training:
  test_size: 0.2
  validation_size: 0.1
  random_state: 42

output:
  models_dir: 'data/models'
  save_feature_importance: true
```

### API Keys and Tokens

**Set environment variables (Bash):**
```bash
export HACKERONE_TOKEN="your_token_here"
export BUGCROWD_TOKEN="your_token_here"
export NVD_API_KEY="your_key_here"
```

**Set environment variables (PowerShell):**
```powershell
$env:HACKERONE_TOKEN="your_token_here"
$env:BUGCROWD_TOKEN="your_token_here"
$env:NVD_API_KEY="your_key_here"
```

---

## ğŸ“ Project Structure
```
bugpredict-ai/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ training_config.yaml        # Training configuration
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ cache/                      # Cached data
â”‚   â”œâ”€â”€ models/                     # Trained models
â”‚   â”œâ”€â”€ raw/                        # Raw collected data
â”‚   â”œâ”€â”€ processed/                  # Processed data
â”‚   â””â”€â”€ results/                    # Analysis results
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ API.md                      # API documentation
â”‚   â””â”€â”€ ARCHITECTURE.md             # System architecture
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ BugPredict_AI_Complete_Tutorial.ipynb
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ analyze_target.py           # Single target analysis
â”‚   â”œâ”€â”€ batch_analyze.py            # Batch analysis
â”‚   â”œâ”€â”€ collect_data.py             # Data collection
â”‚   â”œâ”€â”€ train_model.py              # Model training
â”‚   â”œâ”€â”€ evaluate_models.py          # Model evaluation
â”‚   â”œâ”€â”€ migrate_to_enhanced.py      # Migration script
â”‚   â””â”€â”€ generate_nuclei_templates.py
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ collectors/
â”‚   â”‚   â”œâ”€â”€ data_sources.py         # Base data structures
â”‚   â”‚   â”œâ”€â”€ enhanced_extractor.py   # Enhanced vulnerability detection
â”‚   â”‚   â”œâ”€â”€ hackerone_scraper.py    # HackerOne collector
â”‚   â”‚   â”œâ”€â”€ bugcrowd_scraper.py     # Bugcrowd collector
â”‚   â”‚   â””â”€â”€ cve_collector.py        # NVD/CVE collector
â”‚   â”œâ”€â”€ preprocessing/
â”‚   â”‚   â”œâ”€â”€ normalizer.py           # Data normalization
â”‚   â”‚   â”œâ”€â”€ deduplicator.py         # Deduplication
â”‚   â”‚   â””â”€â”€ enricher.py             # Data enrichment
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â””â”€â”€ feature_engineer.py     # Feature engineering
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ vulnerability_classifier.py  # Vulnerability predictor
â”‚   â”‚   â”œâ”€â”€ severity_predictor.py        # Severity predictor
â”‚   â”‚   â””â”€â”€ chain_detector.py            # Chain detector
â”‚   â”œâ”€â”€ training/
â”‚   â”‚   â””â”€â”€ pipeline.py             # Training pipeline
â”‚   â””â”€â”€ inference/
â”‚       â””â”€â”€ predictor.py            # Threat predictor
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test_enhanced_vulnerabilities.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ setup.py
â””â”€â”€ README.md
```

---

## ğŸ“ Jupyter Notebook Tutorial

Launch the complete tutorial notebook:

**Bash:**
```bash
jupyter notebook notebooks/BugPredict_AI_Complete_Tutorial.ipynb
```

**PowerShell:**
```powershell
jupyter notebook notebooks/BugPredict_AI_Complete_Tutorial.ipynb
```

The notebook covers:
1. Data Collection (HackerOne, Bugcrowd, NVD)
2. Data Preprocessing
3. Feature Engineering
4. Model Training
5. Vulnerability Prediction
6. Batch Analysis
7. Results Visualization

---

## ğŸ¤ Contributing

We welcome contributions! Here's how to get started:

**Bash:**
```bash
# Fork and clone
git clone https://github.com/yourusername/bugpredict-ai.git
cd bugpredict-ai

# Create feature branch
git checkout -b feature/amazing-feature

# Make changes and test
pytest tests/ -v

# Commit and push
git add .
git commit -m "Add amazing feature"
git push origin feature/amazing-feature
```

**PowerShell:**
```powershell
# Fork and clone
git clone https://github.com/yourusername/bugpredict-ai.git
cd bugpredict-ai

# Create feature branch
git checkout -b feature/amazing-feature

# Make changes and test
pytest tests/ -v

# Commit and push
git add .
git commit -m "Add amazing feature"
git push origin feature/amazing-feature
```

---

## ğŸ› Troubleshooting

### Common Issues

**Issue: `ModuleNotFoundError: No module named 'src'`**

**Solution (Bash):**
```bash
export PYTHONPATH="${PYTHONPATH}:$(pwd)"
python scripts/analyze_target.py ...
```

**Solution (PowerShell):**
```powershell
$env:PYTHONPATH="$env:PYTHONPATH;$(Get-Location)"
python scripts/analyze_target.py ...
```

---

**Issue: Models not found**

**Solution:**
```bash
# Train models first
python scripts/train_model.py --quick
```

---

**Issue: Out of memory during training**

**Solution:**
Reduce data size in config:
```yaml
data_collection:
  hackerone_limit: 1000  # Reduced from 5000
  bugcrowd_limit: 500    # Reduced from 2000
```

---

**Issue: Slow performance**

**Solution:**
Enable caching:
```bash
# Data is cached automatically
python scripts/collect_data.py --source all  # First run: slow
python scripts/collect_data.py --source all  # Subsequent: fast (uses cache)
```

---

## ğŸ“Š Performance Benchmarks

Tested on:
- **CPU**: Intel i7-9700K
- **RAM**: 16GB
- **OS**: Ubuntu 22.04 LTS

| Operation | Speed |
|-----------|-------|
| Vulnerability Type Extraction | 1,250 extractions/sec |
| Chain Detection | 156 detections/sec |
| Feature Engineering | ~500 reports/sec |
| Single Target Analysis | ~2-5 seconds |
| Model Training (10K reports) | ~10-15 minutes |

---

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ™ Acknowledgments

QQ

---

## ğŸ“ Support

QQ

---

## ğŸ—ºï¸ Roadmap

- [x] 40+ vulnerability types
- [x] 25+ attack chains
- [x] Enhanced ML models
- [x] Complete test suite
- [x] Migration scripts
- [ ] Web UI dashboard
- [ ] Real-time scanning integration
- [ ] Nuclei template auto-generation
- [ ] Burp Suite extension
- [ ] REST API server
- [ ] Docker containerization
- [ ] Cloud deployment guides

---

**Made with â¤ï¸ by security researchers, for security researchers**

*Happy Hunting! ğŸ¯*
